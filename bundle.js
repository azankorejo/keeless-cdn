!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Keeless=e():t.Keeless=e()}("undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var n,r,a,s,i=[],c=!0,l=!1;try{if(a=(o=o.call(t)).next,0===e){if(Object(o)!==o)return;c=!1}else for(;!(c=(n=a.call(o)).done)&&(i.push(n.value),i.length!==e);c=!0);}catch(t){l=!0,r=t}finally{try{if(!c&&null!=o.return&&(s=o.return(),Object(s)!==s))return}finally{if(l)throw r}}return i}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}t.d(e,{default:()=>i});const i=function(){return t=function t(e,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"k_t_access";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.domain=e,this.sKey=o,this.authTokenKey=n},(e=[{key:"getQueryParam",value:function(t){return new URLSearchParams(window.location.search).get(t)}},{key:"setHttpOnlyCookie",value:function(t){var e=this,o=new FormData;o.set("access_token",this.sKey),fetch("https://".concat(this.domain,".passwordless.test/api/v1/authenticate/").concat(this.getQueryParam("token")),{method:"POST",body:o,headers:{Accept:"application/json"}}).then((function(t){return t.json()})).then((function(t){t.hasOwnProperty("token")&&(document.getElementById("logout").style.display="block",localStorage.setItem(e.authTokenKey,t.token))}))}},{key:"validateSession",value:function(){var t=this;if(localStorage.getItem(this.authTokenKey)){var e=new FormData;e.set("access_token",this.sKey),e.set(this.authTokenKey,localStorage.getItem(this.authTokenKey)),fetch("https://".concat(this.domain,".passwordless.test/api/v1/authenticate/").concat(this.getQueryParam("token")),{method:"POST",body:e,headers:{Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){e.hasOwnProperty("token")&&(document.getElementById("logout").style.display="block",localStorage.setItem(t.authTokenKey,e.token))}))}}},{key:"logout",value:function(){var t=this;if(localStorage.getItem(this.authTokenKey)){var e=new FormData;e.set("access_token",this.sKey),e.set(this.authTokenKey,localStorage.getItem(this.authTokenKey)),fetch("https://".concat(this.domain,".passwordless.test/api/v1/logout"),{method:"POST",body:e,headers:{Accept:"application/json"}}).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((function(e){!0===e.logout_status&&(localStorage.removeItem(t.authTokenKey),window.location.href=e.callback_url)})).catch((function(t){console.error("Logout error:",t)}))}}},{key:"verifyOtp",value:function(t){var e=this,o=new FormData;o.set("otp",t.toString()),o.set("access_token",this.sKey),fetch("https://".concat(this.domain,".passwordless.test/api/v1/consumer/otp/verification"),{method:"POST",body:o,headers:{Accept:"application/json"}}).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((function(t){t.hasOwnProperty("token")&&(localStorage.setItem(e.authTokenKey,t.token),window.location.href=t.callback_url)})).catch((function(t){console.error("Registration error:",t)}))}},{key:"register",value:function(t){if("object"!==r(t))throw new Error("The data passed into the Register function should be an object. Expected Object, Given "+r(t));var e=new FormData;e.set("access_token",this.sKey);for(var n=0,a=Object.entries(t);n<a.length;n++){var s=o(a[n],2),i=s[0],c=s[1];e.set(i,c)}fetch("https://".concat(this.domain,".passwordless.test/api/v1/register"),{method:"POST",body:e,headers:{Accept:"application/json"}}).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((function(t){console.log("Registration successful:",t)})).catch((function(t){console.error("Registration error:",t)}))}},{key:"login",value:function(t){var e=new FormData;e.set("access_token",this.sKey),e.set("email",t),console.log("sent"),fetch("https://".concat(this.domain,".passwordless.test/api/v1/login"),{method:"POST",body:e,headers:{Accept:"application/json"}}).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then((function(t){console.log("Login successful:",t)})).catch((function(t){console.error("Login error:",t)}))}}])&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();return e=e.default})()));